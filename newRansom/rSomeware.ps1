Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
 




## 完了画面表示
#デスクトップサイズ取得
$dskHeight = gwmi win32_videocontroller | select -ExpandProperty CurrentVerticalResolution
$dskWidth = gwmi win32_videocontroller | select -ExpandProperty CurrentHorizontalResolution
#$formHeight = $dskHeight * 0.8
#$formWidth = $dskWidth * 0.8
$formHeight = 600
$formWidth = 800
echo $formHeight
echo $formWidth

#フォーム
$form = New-Object System.Windows.Forms.Form 
$form.Text = "イメージテスト"
$form.Size = New-Object System.Drawing.Size($formWidth,$formHeight) 
$form.StartPosition = "CenterScreen"
$form.AutoSize = $True
$form.FormBorderStyle = "None"
#$form.WindowState = "Maximized"
#$form.AutoSizeMode = "GrowAndShrink"
$form.BackColor = "#FFFFFFFF"

#寄付ボタン
$buttonPy = $formHeight - 60
$buttonPx = $formWidth - 200
echo $buttonPy, $buttonPx
$donateButton = New-Object System.Windows.Forms.Button
$donateButton.Location = New-Object System.Drawing.Point($buttonPx,$buttonPy)
$donateButton.Size = New-Object System.Drawing.Size(150,50)
$donateButton.Text = 'Donate'
$donateButton.DialogResult = [System.Windows.Forms.DialogResult]::OK
$form.AcceptButton = $donateButton
$form.Controls.Add($donateButton)

 
#PictureBox
$pic = New-Object System.Windows.Forms.PictureBox
$pic.Size = New-Object System.Drawing.Size($formWidth,$formHeight)
$pic.Image = [System.Drawing.Image]::FromFile("\DATA\CSL\R_Malware\newRansom\CSL_Logo-dark.png")
$pic.Location = New-Object System.Drawing.Point(0,0) 
$pic.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::Zoom
$form.Controls.Add($pic) 
 
#フォームを表示
$result = $form.ShowDialog()
$form.WindowState = "Normal"
$form.FormBorderStyle = "None"
$form.WindowState = "Maximized"
 
#リソースを開放
$pic.Image.Dispose()
$pic.Image = $null
